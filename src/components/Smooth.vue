<template>

</template>

<script>
/**
 * ···'''-,,-;\----:-,",-\-----\;]jvt>*~^",,,-"·····~,-\--,-(=:--,^^^^^^^^^^^~,,,-,,""",-=i\--,^^·,-,,_
·'''''~-*[=***):--:]]::-,--|)l11\---:"··^~---:-::----"^"----:!;^-(,~,|--,,"~~·········^",,"~^^~----_
''''``·*11|-*)=)++|--|:-|\-*\---,,,,,,,,,,,,,,,,"",,,,~~~~~^~",,--",--,^^^^·······^^^^^^~~^^~"^~~,-_
````'-|\--!::|\!:---\:\**-,,"~~~~~~~~~^^···^^^^","~,,,,,,,,,,,,"~~~'·····^^^^^~,----,,,-,,--,,~^^~~_
````·--:=*--******---,,,,,,,---\)ij}]=*|--,"~~^^^^^~~~~^~~",,,,,,,,""~^^·^·^^^····^~~^^^^^,,,,,,,,,_
```'~,|\))---*r+------|-DBMMMMMMMMMMMMMMMMMMMMBWE01-^^^^···^~,,,,,,,,,"~~~~^^,,^^~,,,~^^~^·^~~^···^_
``'^-+1(;=|----|*):·`·-SMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMB@},····^~,,,,,,,"~~~~^^""^^^~~^^^····^~~~~^_
`'"-----:|:)]*-'````'·]BMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMQG]"···^,,,,,,,,~~~~^"^^^^^·····^~~",^^_
`·--)-\)*;-'````````·-BMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM}···^~,,,,"~~~~~~~~^^^^^^^^^^^^··_
*=>+;|,'````````````·vMMMMMMMMMMMMMMMMMMMMMMMMMMQMQMMMMMMMMMMMMMMMMMQP-···~,,"~~~~~~~~~~~~~^^^^^^^^_
*\-·''``````````````·rMMMMMMMMMMMMMMMMMMMMEHBqdMEqQMMMMMMMMMMMMMMMMMMMMMK]··^~,,,"~~~~~~~~~~^^^~~~~_
''''''''````````````·tBMMMMMMMMMMMMMQHPSuv[}v]jL2k6ABMMMMMMMMMMMMMMMMMMMMMMB}"·^~,,"~~"~~~~~~~~~~~~_
'''''''''```````````'^KMMMMMBQQMMBWK0v*,,,,""",,,,-*1ndBMMMMMMMMMMMMMMMMMMMMMMMS-·^^~~,,,,,"~~^~~~~_
'''''''''````````````'~sMMP2vrti}}rjJuv}*--,,~~",,,-\=lvu&0P0nuvu0PGNMMMMMMMMMMMMMW&-^^^^,,,,,"~~~~_
'''''''''''```````````'·rQ$KQQMMQMWHVV&jjv=:-,~~,,-----:+tvu400VJ}}}vCXNQMMMMMMMMMMMMMQa*,"~~~,"~~~_
'''''''''''`````````````'1%aXmG&\}RXB$@Civv}-"^~"-----\ijmBMMMMMNBdYunC&0$OAdBMMMMMMMMMMMMMQ0-·",~^_
''''''''''''''``````````'·vvvt&DPY}vj)|)ji!]\~^",,--:=0J;,jGBqA*}00u3vr}jvnV0PKMMMMMMMMMMMMX=_______
'''''''''''''''`````````''ti+*\;*;|-----::;+-"~,,,,,,-:!=1i}j>i]*--,-:(=]1jvv$WBMMMMMMMMMMm,________
'''''''''''''''````````,',}=\-----,-----|*>:,~",-,,,",,,,,,--,,,,,~~~",-;[}tv$bEEBMMD%$Puvi_________
'''''''''''''''````````(--i);---,,,,---|*>=-"·",-,,,~^^~",,"~~~~~~~~~,,,,-*}vkdWMMWK0JTc[}\_________
''''''``''''''``````````'-}]*:---,,----\)):,"~,,--,,~^^^^~~~~~~~~~~",,,---:+t0DWBQQGvi1}}*,'`_______
``````````````````````````]}=;---------;*:,"^·~,----,^^^^~~~~~~~~~",,,---:\*=vvlUl\>=1ii-^^,·_______
`````````''```````````````~sr)*\:::---|rn),"",---,,,--,,,"~~~~~~~",,,,--:\\\\+12n0t+*]+----"~_______
```````````````````````````;02t]**;;\:1UPPv]-=}]jj)*-"~,---,,,,,,,,----|\::--:vUi)\:--,··''·`'______
```````````````````````````'vU0vi])!\|::13J1=\-,,"~^~~"",,----------::\|-----|=;:---,"^··"·^·'______
````````````````````````````·su}=)=}v}+\---,,,,,,"",,,,----------::-::------------,,,"~^'·'_________
```````````````````````````,\v&2i*-:+0NA0vi)>+***;**+)icK}---,-------------------,'''··'`___________
``````````````````````````:---i&&u1**=vLv]\---------::--,,,,,---------------,",--,·`````'___________
``````````````````````````````-,u%3}]==1itv}]=**!\:--,,,,,,,-----------:\\-,^^~,"~```````___________
``````````````````````````````',^:Vu}=*;|:----,,",,,,,,,,,,,-------|\;*+*\-,~^^^^^·`````____________
''`````````````````````````````,,··-&v1+|--,,,,~~~~,,,,,,-------\)]):------,,~~~^^·```______________
''''''`````````````````````````'~'··^-vv]*:---,,,,,------::|*1vVuj:----,,,--,~~-|--`________________
'''''''''''```````````````````'--*\::::\\=tj}1[**\|\!*[ii}vjJv}1>|-,,,,,-----,,---(*'_______________
'''''''''''```````````````````'-:::,·'''''···^v0Vnntu02uv[):*\--,--,^^"···~^···^,----`______________
'''''''''''''''```````````````````·''''''·····^]t}=vun&0&v=:,"~~~~,-~···^^^····^,--,,~```_____`````_
'''''''''''''''''``````````````````''''······^-i}:t4sCssVu}\--,^·^-,^··········"---,---^'``````````_
''''''''''''''''''''````````````````········^,-;\uP04cj]=)*\---,~~~^^··^^^^~~",,-----,,,--'````````_
'''''''''''''''''''```````````````````'''··^^,-^'CS62i***\---,,,,,---,,,,,,,,------,,,,,,,,^^^^^··'_
'''''```'''''''```````````````````````````````````]0Ji===+**\\\:----,,,--------,"~~~~~~~~~~~~~~",,,_
```````````````````````````````````````````````'~-:c3vj}i])!:------:\;\::--,,~"""",,,,""",,,,,,,,,,_
`````````````````````````````````````````````~--*}0&uvvr])*;\\--:\+)*\|-,"",,,--,,,,,,"~~~~",,,,,,,_
```````````````````````````````````````````^-:=vV0Jtjr}i]:------\*>*-,",,,--,,,,,",,,,"~~~~~,,,,,--_

 */
// https://github.com/JS-Hao/blog/issues/4

import mixin from '../components/mixin.js'
export default {
    mixins: [mixin],
    data() {
        return {
            lastDeg: undefined,
        };
    },
    mounted() {
        this.bindEvn();
    },
    computed: {
        domRect() {
            return this.can.getBoundingClientRect();
        }
    },
    methods: {
        bindEvn() {
            this.can.addEventListener('mousedown', this.handleMouseDown);

        },
        handleMouseDown(e) {
            let {
                ctx
            } = this;
            let sx = e.clientX - this.domRect.x;
            let sy = e.clientY - this.domRect.y;
            ctx.beginPath();
            ctx.moveTo(sx, sy);

            let handleMouseMove = (e) => {
                let {
                    ctx
                } = this;
                let mx = e.clientX - this.domRect.x;
                let my = e.clientY - this.domRect.y;
                let tempX = mx - sx;
                let tempY = my - sy;
                sx = mx;
                sy = my;

                /******************* 角度方案 */
                let deg = Math.atan2(tempY, tempX) * 180 / Math.PI;
                if (this.lastDeg !== undefined) {
                    ctx.lineTo(mx, my);
                    ctx.stroke();
                    // console.log(this.lastDeg, deg, Math.abs(this.lastDeg - deg));
                    if (this.lastDeg * deg > 0 && Math.abs(this.lastDeg - deg) > 1) {
                        console.log('change', this.lastDeg - deg)
                    }
                }
                this.lastDeg = deg;
            };

            let handleMouseUp = (e) => {
                console.log('up')
                this.lastDeg = undefined;
                this.can.removeEventListener('mousemove', handleMouseMove);
                this.can.removeEventListener('mouseup', handleMouseUp);
                this.can.removeEventListener('mouseout', handleMouseUp);
            }

            this.can.addEventListener('mousemove', handleMouseMove);
            this.can.addEventListener('mouseup', handleMouseUp);
            this.can.addEventListener('mouseout', handleMouseUp);
        },

    }
}
</script>
